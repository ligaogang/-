@{
    ViewBag.Title = "IndexAP_PlantNoPointSource";
    Layout = "../Shared/_LayoutBody.cshtml";
    }
<style>
    .ui-search-toolbar {
    display:none;
    }
    td.text-middle {
    text-align:center !important;
    vertical-align:middle !important;
    }
    th.ui-th-column-header.ui-th-ltr {
    border-bottom:1px solid #ddd !important;
    }
    th.ui-th-column.ui-th-ltr {
     border-bottom:1px solid #ddd !important;
    }
        .ui-menu-item .ui-common-table:hover {
    background:#b3d4fc;
    color:#5887c6;
    }
</style>
    <form class="form form-horizontal form-custom-default"style="width:98%;" id="FormAssesOfYearFinal">
            <div class="form-group">
          <div class="col col-sm-1"><label class="label-custom-default pull-right">年份：</label></div>
                <div class="col col-sm-2"> <input name="Year" type="text" class="form-control" style="height:30px;line-height:30px;" placeholder="测试时间",
                onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy',onpicked:beginSearch()})" readonly="true" /></div>
       
                </div> <div class="form-group">
            <div class="col col-sm-12">

<table class="table table-custom-default table-line-height40" id="AP_PlantNoPointSourceList"></table>
                </div></div>
    </form>

<script>
    function resizeGrid() {
        $(window).unbind("onresize");
        $("#AP_PlantNoPointSourceList").setGridHeight($(window).height()-140);
        $(window).bind("onresize", this);
    }
    $(function () {
        $("#FormAssesOfYearFinal").find("[name=Year]").val(new Date(2016, 1, 1).getFullYear());
        beginSearch();
    })
    var col = [
     { name: "Id", hidden: true, key: true },
     {
         label: "序号",
         classes:"text-middle",
         name: "SeqNo",
         sortable: false,
         colmenu: false,
         sortable: false,
         width: 100,
         colmenu: false
     },
     {
         label: "区县",
         name: "AreaName",
         classes: "text-middle",
         sortable: false,
         
         classes: "text-middle",
         isVisible: true,
         width: 100,
         coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

     },
     {
         label: "化肥施用（折纯量，吨）",
         index: "Nitrogenours",
         name: "Nitrogenours",
         classes: "text-middle",
         sortable: false,
      
         width: 120,
         isVisible: true,
         coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
     },
           {
               label: "氮肥",
               index: "AssesLeaderName",
               name: "AssesLeaderName",
               sortable: false,
               classes: "text-middle",
               colmenu: false,
               width: 100,
               isVisible: true,
               coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
           },
                 {
                     label: "磷肥",
                     index: "ParticipateTypeName",
                     name: "ParticipateTypeName",
                     classes: "text-middle",
                     sortable: false,
                     colmenu: false,
                     width: 100,
                     isVisible: true,
                     coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                 },
                       {
                           label: "复合肥",
                           index: "ComplexFertilizer",
                           name: "ComplexFertilizer",
                           sortable: false,
                           classes: "text-middle",
                           colmenu: false,
                           width: 100,
                           isVisible: true,
                           coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                       },
                        {
                            label: "蔬菜（吨）",
                            name: "Vegetable",
                            classes: "text-middle",
                            sortable: false,
                            colmenu: false,
                            width: 100,
                            isVisible: true,
                            coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                        },
                                         {
                                             label: "播种面积（公顷）",
                                             name: "SeedArea",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },                 {
                                             label: "粮食产量（吨）",
                                             name: "GrainOutput",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },                 {
                                             label: "稻谷",
                                             name: "Rice",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },                 {
                                             label: "谷子",
                                             name: "Millet",
                                             sortable: false,
                                             classes: "text-middle",
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },                 {
                                             label: "玉米",
                                             name: "Mize",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },                 {
                                             label: "薯类",
                                             name: "Potato",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },                 {
                                             label: "高粱",
                                             name: "Sorghum",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },                 {
                                             label: "小麦",
                                             name: "Wheat",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },                 {
                                             label: "豆类",
                                             name: "Bean",
                                             sortable: false,
                                             classes: "text-middle",
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },                 {
                                             label: "油料（吨）",
                                             name: "OilPlant",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },                 {
                                             label: "花生",
                                             name: "Pinut",
                                             sortable: false,
                                             classes: "text-middle",
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },         {
                                             label: "芝麻",
                                             name: "Sesame",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },         {
                                             label: "向日葵",
                                             name: "SunFlower",
                                             sortable: false,
                                             classes: "text-middle",
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },

                                         },         {
                                             label: "棉花",
                                             name: "Cottom",
                                             classes: "text-middle",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         },         {
                                             label: "油菜",
                                             classes: "text-middle",
                                             name: "OilseedRaoe",
                                             sortable: false,
                                             colmenu: false,
                                             width: 100,
                                             isVisible: true,
                                             coloptions: { sorting: true, columns: false, filtering: true, seraching: true, grouping: false, freeze: true }, searchoptions: { searchOperMenu: false, sopt: ['eq', 'lt', 'gt'] },
                                         }

    ];
    function beginSearch() {
        var Year = $("#FormAssesOfYearFinal").find("[name=Year]").val();
        $.ajax({
            url: "/AP_PlantNoPointSource/GetAP_PlantNoPointSourceList",
            data: { Year: Year },
            async: true,
            dataType: 'json',
            type: "POST",
            success: function (json) {
                var SeqNum = 1;
                if (json.Result) {
                    $.each(json.Entity, function (i, n) {
                        json.Entity[i].SeqNo = SeqNum++;
                    });
                    page_init(json.Entity, col)
                } else {
                    bAlert("获取信息失败");
                }
            },
            error: function (errorData) {
            },
            complete: function () {
            }
        });
    }
    function page_init(tableJson, columnType) {
        $.jgrid.gridUnload("#AP_PlantNoPointSourceList");
        $('#AP_PlantNoPointSourceList').jqGrid({
            datatype: "local",
            data: tableJson,

            gridComplete: function () {

            },
            loadComplete: function (json) {
                resizeGrid();
            },
            colModel: columnType,

            loadError: function (json, status, error) {
            },

            width: "100%",
            heiht: "100%",
            autowidth: true,
            colMenu: true,
            rowNum: tableJson.length,
            loadonce: true,
            ondblClickRow: function (rowid, iRow, iCol, e) {


            },
            onSelectRow: function (rowid, status) {
               
            },
        });
        $(window).resize(function () {

            resizeGrid();
        })
        $("#AP_PlantNoPointSourceList").jqGrid('setGroupHeaders', {
            useColSpanStyle: true,
            groupHeaders: [{ startColumnName: 'Nitrogenours', numberOfColumns: 4, titleText: '化肥施用（折纯量，吨）' },
            { startColumnName: 'Vegetable', numberOfColumns: 2, titleText: '园艺作物' },
            { startColumnName: 'GrainOutput', numberOfColumns: 8, titleText: '粮食作物' },
            { startColumnName: 'OilPlant', numberOfColumns: 6, titleText: '经济作物' }]
        })
    }

</script>
